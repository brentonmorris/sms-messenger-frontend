<div class="bg-white p-6 rounded-lg shadow-md h-full">
  <h2 class="text-2xl font-bold text-gray-800 mb-6">New Message</h2>

  <form [formGroup]="messageForm" (ngSubmit)="onSubmit()" class="space-y-4">
    <!-- Phone Number Field -->
    <div>
      <label
        for="phoneNumber"
        class="block text-sm font-medium text-gray-700 mb-1"
      >
        Phone Number
      </label>
      <input
        type="tel"
        id="phoneNumber"
        value="+1 (877) 780-4236"
        readonly
        class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-600 cursor-not-allowed"
      />
    </div>

    <!-- Message Field -->
    <div>
      <label for="message" class="block text-sm font-medium text-gray-700 mb-1">
        Message
      </label>
      <textarea
        id="message"
        formControlName="message"
        rows="4"
        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-vertical"
        placeholder="Enter your message here..."
        [class.border-red-500]="message?.invalid && message?.touched"
        (keydown.enter)="$event.preventDefault(); onSubmit()"
      ></textarea>

      <!-- Character Counter -->
      <div class="flex justify-between items-center mt-1">
        <div
          *ngIf="message?.invalid && message?.touched"
          class="text-sm text-red-600"
        >
          <div *ngIf="message?.errors?.['required']">Message is required.</div>
          <div *ngIf="message?.errors?.['maxlength']">
            Message cannot exceed 160 characters.
          </div>
        </div>
        <span
          class="text-xs text-gray-500"
          [class.text-red-500]="(message?.value?.length || 0) > 160"
        >
          {{ message?.value?.length || 0 }}/160
        </span>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex space-x-3">
      <!-- Clear Button -->
      <button
        type="button"
        (click)="clearForm()"
        [disabled]="isSubmitting"
        class="flex-1 bg-gray-100 hover:bg-gray-200 disabled:bg-gray-50 text-gray-700 font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition duration-200"
      >
        Clear
      </button>

      <!-- Submit Button -->
      <button
        type="submit"
        [disabled]="isSubmitting"
        class="flex-1 bg-black hover:bg-gray-800 disabled:bg-gray-400 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition duration-200"
      >
        <span *ngIf="!isSubmitting">Send</span>
        <span *ngIf="isSubmitting" class="flex items-center justify-center">
          <svg
            class="animate-spin -ml-1 mr-2 h-4 w-4 text-white"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
          >
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            ></path>
          </svg>
          Sending...
        </span>
      </button>
    </div>
  </form>

  <!-- Success Message -->
  <div
    *ngIf="submitSuccess"
    class="success-message mt-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded-md"
    [class.fade-out]="isFadingOut"
  >
    <div class="flex items-center">
      <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
        <path
          fill-rule="evenodd"
          d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
          clip-rule="evenodd"
        ></path>
      </svg>
      Message sent!
    </div>
  </div>

  <!-- Error Message -->
  <div
    *ngIf="submitError"
    class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md"
  >
    <div class="flex items-center">
      <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
        <path
          fill-rule="evenodd"
          d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z"
          clip-rule="evenodd"
        ></path>
      </svg>
      Failed to send message. Please try again.
    </div>
  </div>
</div>
